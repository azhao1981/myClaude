---
name: technical-analysis
description: 执行深度的五层技术分析并输出到文档。注意：除非用户明确要求，否则严禁输出时间估算。
---

# 五层技术分析法 (含文档输出)

## 0. 上下文排毒 (Context Detox)
- **识别毒素**: 检查上下文中是否有臆造的 "3-4周"、"短期/长期"。
- **主动免疫**: 
  - 默认情况：**严禁模仿**，输出纯技术分析。
  - **例外情况**: 仅当用户本次指令明确包含 "估时"、"排期"、"计划" 时，才允许参考或生成时间相关内容。

## 1. 数据结构 (Data Structure)
- 核心数据是什么？关系如何？

## 2. 特殊情况 (Special Cases)
- 识别 if/else 分支与补丁。

## 3. 复杂度审查 (Complexity Review)
- 本质是什么？缩进是否超过3层？

## 4. 破坏性分析 (Breaking Analysis)
- 是否破坏了现有功能？

## 5. 实用性验证 (Practicality)
- **默认原则**: 只谈复杂度(O)、代码行数、风险。
- **时间估算特权**:
  - ❌ **User 未要求**: 绝对不写 "开发周期" 或 "工期"。
  - ✅ **User 明确要求**: 可以提供估算，但必须遵循以下格式：
    > "基于[假设条件]的粗略估算：[时间范围]，风险在于[具体风险点]"

## 输出模板

### 决策分析报告
- **【核心判断】** ✅ 值得做 / ❌ 不值得做
- **【关键洞察】** (数据结构、复杂度、风险)
- **【方案对比】** *(注意：除非用户要求，否则表格中不得出现"工期/时间"列)*
  | 维度 | 方案 A | 方案 B |
  | --- | --- | --- |
  | 机制 | ... | ... |
  | 复杂度 | ... | ... |
- **【方案评分】** 🟢 A级 | 🟡 B级 | 🔴 C级

---

## 文档输出

分析结果**必须写入** 当前工作主目标文档 或 `[doc|docs]/analysis/{topic}.md`(UTF-8),使用 Write 工具。